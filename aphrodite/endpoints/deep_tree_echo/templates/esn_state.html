{% extends "base.html" %}

{% block title %}ESN State - Deep Tree Echo{% endblock %}

{% block header_title %}Echo State Network{% endblock %}

{% block content %}
<div class="card">
    <h2>Reservoir Configuration</h2>
    <div class="code-block">
        <h4>Network Parameters</h4>
        <pre>Reservoir Type: {{ data.reservoir_type|upper }}
Reservoir Size: {{ data.reservoir_size }} nodes
Connectivity: {{ data.connectivity|title }}
Activation Function: {{ data.activation }}
Spectral Radius: {{ data.spectral_radius }}
Leaky Rate: {{ data.leaky_rate }}
Current State: {{ data.state|upper }}
Server Rendered: {{ data.server_rendered }}</pre>
    </div>
</div>

<div class="card">
    <h2>Reservoir Status</h2>
    <div class="status-badge {% if data.state == 'ready' %}status-success{% else %}status-warning{% endif %}">
        ESN Status: {{ data.state|upper }}
    </div>
    
    <div style="margin-top: 1.5rem;">
        <h3>Network Properties</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1rem;">
            <div class="card" style="margin: 0;">
                <h4>Size</h4>
                <p>{{ data.reservoir_size }} neurons</p>
            </div>
            <div class="card" style="margin: 0;">
                <h4>Connectivity</h4>
                <p>{{ data.connectivity|replace('_', ' ')|title }}</p>
            </div>
            <div class="card" style="margin: 0;">
                <h4>Spectral Radius</h4>
                <p>{{ data.spectral_radius }}</p>
            </div>
            <div class="card" style="margin: 0;">
                <h4>Leaky Rate</h4>
                <p>{{ data.leaky_rate }}</p>
            </div>
        </div>
    </div>
</div>

<div class="card">
    <h2>Echo State Network Architecture</h2>
    <p>The ESN reservoir provides temporal dynamics processing:</p>
    <ul style="padding-left: 2rem; margin-top: 1rem;">
        <li><strong>Sparse Random Connectivity:</strong> Efficient network topology</li>
        <li><strong>Tanh Activation:</strong> Non-linear node dynamics</li>
        <li><strong>Spectral Radius Control:</strong> Echo state property maintenance</li>
        <li><strong>Leaky Integration:</strong> Temporal memory management</li>
        <li><strong>Server-Side Processing:</strong> Complete reservoir state computation</li>
    </ul>
</div>

<div class="card">
    <h2>Mathematical Properties</h2>
    <div class="code-block">
        <h4>ESN Dynamics</h4>
        <pre>State Update: x(t+1) = (1-α)x(t) + α·tanh(W·x(t) + W_in·u(t))
Where:
  α = leaky_rate = {{ data.leaky_rate }}
  W = internal weight matrix ({{ data.reservoir_size }}×{{ data.reservoir_size }})
  spectral_radius(W) = {{ data.spectral_radius }}
  activation = {{ data.activation }}</pre>
    </div>
</div>

<div class="card">
    <h2>Integration with DTESN</h2>
    <p>The Echo State Network integrates with the Deep Tree Echo System by:</p>
    <ul style="padding-left: 2rem; margin-top: 1rem;">
        <li><strong>Temporal Processing:</strong> Handling time-series data within membrane hierarchy</li>
        <li><strong>Reservoir Computing:</strong> Non-linear transformation of input streams</li>
        <li><strong>State Persistence:</strong> Maintaining echo state properties across membrane layers</li>
        <li><strong>B-Series Integration:</strong> Supporting rooted tree ridge computations</li>
    </ul>
</div>
{% endblock %}